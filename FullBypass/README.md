# FullBypass

该工具可绕过 AMSI（反恶意软件扫描接口）和 PowerShell CLM（受限语言模式）并为您提供全语言 PowerShell 反向 shell。

```
P.S Please do not use in unethical hacking and follow all rules and regulations of laws
```

用法：

首先，将bypass.csproj文件下载到受害者机器中（找到可写入文件夹，例如C:\Windows\Tasks或C:\Windows\Temp）。之后只需使用msbuild.exe执行它即可。

例子：`C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe .\FullBypass.csproj`

此后代码将执行两件事。

1. 首先，代码将使用内存劫持方法绕过 AMSI，并重写 AmsiScanBuffer 函数中的某些指令。使用 xor 指令，size 参数将为 0，AMSI 无法检测到 powershell 中未来的脚本和命令。

[![图像](https://private-user-images.githubusercontent.com/78950174/305597464-4a444b4d-cfd1-47fd-9cc7-b9e2b92a2f12.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAxNTIxNDIsIm5iZiI6MTcyMDE1MTg0MiwicGF0aCI6Ii83ODk1MDE3NC8zMDU1OTc0NjQtNGE0NDRiNGQtY2ZkMS00N2ZkLTljYzctYjllMmI5MmEyZjEyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MDUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzA1VDAzNTcyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkzNjE3ZmQyOTFjNzk2Yzg3ZjY4MWQyMmM2Njc5MzEwM2EwZmQ1NGUyOTU3MThkYzI4ZDJlODhjNWFhYjhkZDYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.aKieGFcKXWvSgfAOe_l5MEWqlgFxRBp178kBcXy-1mM)](https://private-user-images.githubusercontent.com/78950174/305597464-4a444b4d-cfd1-47fd-9cc7-b9e2b92a2f12.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAxNTIxNDIsIm5iZiI6MTcyMDE1MTg0MiwicGF0aCI6Ii83ODk1MDE3NC8zMDU1OTc0NjQtNGE0NDRiNGQtY2ZkMS00N2ZkLTljYzctYjllMmI5MmEyZjEyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MDUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzA1VDAzNTcyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkzNjE3ZmQyOTFjNzk2Yzg3ZjY4MWQyMmM2Njc5MzEwM2EwZmQ1NGUyOTU3MThkYzI4ZDJlODhjNWFhYjhkZDYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.aKieGFcKXWvSgfAOe_l5MEWqlgFxRBp178kBcXy-1mM)

1. 最后，它会询问你的 IP 和端口，以便为你提供一个 powershell 全语言模式反向 shell。

[![图像](https://private-user-images.githubusercontent.com/78950174/305597493-5b6e609d-30aa-49ea-9fb1-ce5f82ff082e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAxNTIxNDIsIm5iZiI6MTcyMDE1MTg0MiwicGF0aCI6Ii83ODk1MDE3NC8zMDU1OTc0OTMtNWI2ZTYwOWQtMzBhYS00OWVhLTlmYjEtY2U1ZjgyZmYwODJlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MDUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzA1VDAzNTcyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU5ODI4YTg0OGE0MTgxMWM0YzIzNTk4NDI2Y2Q4ZDI1MDE1YzZlYTgwNTM5MzljYjJjZmM4NzAzMzBkMTllOTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.71L7BTkbBj_SACNOtU53P7F_WtYczmdaj7TAxjBsgVQ)](https://private-user-images.githubusercontent.com/78950174/305597493-5b6e609d-30aa-49ea-9fb1-ce5f82ff082e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAxNTIxNDIsIm5iZiI6MTcyMDE1MTg0MiwicGF0aCI6Ii83ODk1MDE3NC8zMDU1OTc0OTMtNWI2ZTYwOWQtMzBhYS00OWVhLTlmYjEtY2U1ZjgyZmYwODJlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MDUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzA1VDAzNTcyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU5ODI4YTg0OGE0MTgxMWM0YzIzNTk4NDI2Y2Q4ZDI1MDE1YzZlYTgwNTM5MzljYjJjZmM4NzAzMzBkMTllOTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.71L7BTkbBj_SACNOtU53P7F_WtYczmdaj7TAxjBsgVQ)

[![图像](https://private-user-images.githubusercontent.com/78950174/305597501-3b81ccdf-b5c9-450d-93f1-b89996a94aee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAxNTIxNDIsIm5iZiI6MTcyMDE1MTg0MiwicGF0aCI6Ii83ODk1MDE3NC8zMDU1OTc1MDEtM2I4MWNjZGYtYjVjOS00NTBkLTkzZjEtYjg5OTk2YTk0YWVlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MDUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzA1VDAzNTcyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTg2OTU4MjZkOGQ4MmI0MGVmZGM3ZjkxZjFhNmYxNjAxMzRhYTIxMmIyMTRmZmE4OTU1OWY0ZDljMGRhY2E5OTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.nSmeLa-ahrMw6UWYHSe4RjOmP-b6X895SXn5s1yhzLs)](https://private-user-images.githubusercontent.com/78950174/305597501-3b81ccdf-b5c9-450d-93f1-b89996a94aee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAxNTIxNDIsIm5iZiI6MTcyMDE1MTg0MiwicGF0aCI6Ii83ODk1MDE3NC8zMDU1OTc1MDEtM2I4MWNjZGYtYjVjOS00NTBkLTkzZjEtYjg5OTk2YTk0YWVlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MDUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzA1VDAzNTcyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTg2OTU4MjZkOGQ4MmI0MGVmZGM3ZjkxZjFhNmYxNjAxMzRhYTIxMmIyMTRmZmE4OTU1OWY0ZDljMGRhY2E5OTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.nSmeLa-ahrMw6UWYHSe4RjOmP-b6X895SXn5s1yhzLs)

如你所见，我们捕获了 powershell FullLanguageMode 反向 shell。